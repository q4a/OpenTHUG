<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenTHUG: Исходный файл C:/git/thug/src/gfx/XBox/NX/instance.cpp</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenTHUG
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">OpenTHUG: let&#39;s port THUG on Linux</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Поиск');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Поиск');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d4/d19/_x_box_2_n_x_2instance_8cpp_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">instance.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp.html">См. документацию.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d6/d45/_nx_light_8h.html">gfx\NxLight.h</a>&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d3/d83/debuggfx_8h.html">gfx\DebugGfx.h</a>&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d3/d83/debuggfx_8h.html">gfx\DebugGfx.h</a>&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d6/d98/symboltable_8h.html">gel/scripting/symboltable.h</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;nx_init.h&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;instance.h&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;anim.h&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;render.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;occlude.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d5f/anim__vertdefs_8h.html">anim_vertdefs.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d4/ddf/namespace_nx_xbox.html">NxXbox</a></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="../../d4/ddf/namespace_nx_xbox.html#a56fe2807aa16bdb672be15e2aa6a6812">   15</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../d9/d37/class_mth_1_1_matrix.html">Mth::Matrix</a>  *<a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a56fe2807aa16bdb672be15e2aa6a6812">pLastBoneTransforms</a>    = NULL;</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="../../d4/ddf/namespace_nx_xbox.html#a03defcc333dc4dae5c05914d0a7b02bd">   16</a></span>&#160;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a>           *<a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a03defcc333dc4dae5c05914d0a7b02bd">pFirstInstance</a>         = NULL;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="../../d4/ddf/namespace_nx_xbox.html#afa8181f7caa5481d0a0b5bcc6c0112e2">   23</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#afa8181f7caa5481d0a0b5bcc6c0112e2">sort_by_bone_transform</a>( <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/dbd/p__netcnfif_8h.html#a987f27df2a5f3c9f3b402784624cfac3">p1</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/dbd/p__netcnfif_8h.html#a22f7a8363a7f95b437d6df82a4284cd7">p2</a> )</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a>   *p_mesh1        = *((<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a>**)<a class="code" href="../../d7/dbd/p__netcnfif_8h.html#a987f27df2a5f3c9f3b402784624cfac3">p1</a> );</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a>   *p_mesh2        = *((<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a>**)<a class="code" href="../../d7/dbd/p__netcnfif_8h.html#a22f7a8363a7f95b437d6df82a4284cd7">p2</a> );</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="../../d9/d37/class_mth_1_1_matrix.html">Mth::Matrix</a> *p_mat1         = p_mesh1-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>();</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="../../d9/d37/class_mth_1_1_matrix.html">Mth::Matrix</a> *p_mat2         = p_mesh2-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">if</span>(( p_mat1 == NULL ) || ( p_mesh1-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a91cf038b863ac04e4ae109b972b761bb">m_numHierarchyObjects</a> &gt; 0 ))</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">if</span>(( p_mat2 == NULL ) || ( p_mesh2-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a91cf038b863ac04e4ae109b972b761bb">m_numHierarchyObjects</a> &gt; 0 ))</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            <span class="keywordtype">int</span> num_st1 = p_mesh1-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a40d6ceb1649611a5dfd119512a9fafa4">m_num_semitransparent_mesh_entries</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="keywordtype">int</span> num_st2 = p_mesh2-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a40d6ceb1649611a5dfd119512a9fafa4">m_num_semitransparent_mesh_entries</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <span class="keywordflow">if</span>( num_st1 == num_st2 )</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                <span class="comment">// Try sorting on the material draw order of the first semitransparent mesh.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                <span class="keywordflow">if</span>( num_st1 &gt; 0 )</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                    <a class="code" href="../../da/df5/struct_nx_xbox_1_1s_material.html">NxXbox::sMaterial</a>   *p_material1 = p_mesh1-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a1d262cf8d090a7c21d8176d3c1cea899">m_meshes</a>[p_mesh1-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#ac8b1b40b99999d1f37bbeed8e734bb9c">m_first_semitransparent_entry</a>]-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#ade65b339f79a19614775db76aade229b">mp_material</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                    <a class="code" href="../../da/df5/struct_nx_xbox_1_1s_material.html">NxXbox::sMaterial</a>   *p_material2 = p_mesh2-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a1d262cf8d090a7c21d8176d3c1cea899">m_meshes</a>[p_mesh2-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#ac8b1b40b99999d1f37bbeed8e734bb9c">m_first_semitransparent_entry</a>]-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#ade65b339f79a19614775db76aade229b">mp_material</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                    <span class="keywordflow">if</span>( p_material1 &amp;&amp; p_material2 )</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                    {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                        <span class="keywordflow">return</span> ( p_material1-&gt;<a class="code" href="../../da/df5/struct_nx_xbox_1_1s_material.html#ad31897c8160e29447c188946d92edea5">m_draw_order</a> &gt; p_material2-&gt;<a class="code" href="../../da/df5/struct_nx_xbox_1_1s_material.html#ad31897c8160e29447c188946d92edea5">m_draw_order</a> ) ? 1 : (( p_material1-&gt;<a class="code" href="../../da/df5/struct_nx_xbox_1_1s_material.html#ad31897c8160e29447c188946d92edea5">m_draw_order</a> &lt; p_material2-&gt;<a class="code" href="../../da/df5/struct_nx_xbox_1_1s_material.html#ad31897c8160e29447c188946d92edea5">m_draw_order</a> ) ? -1 : 0 );</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="keywordflow">return</span> ( num_st1 &gt; num_st2 ) ? 1 : -1;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(( p_mat2 == NULL ) || ( p_mesh2-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a91cf038b863ac04e4ae109b972b761bb">m_numHierarchyObjects</a> &gt; 0 ))</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// At this stage we know both instances have bone transforms.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span>( p_mat1 == p_mat2 )</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordtype">int</span> num_st1 = p_mesh1-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a40d6ceb1649611a5dfd119512a9fafa4">m_num_semitransparent_mesh_entries</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordtype">int</span> num_st2 = p_mesh2-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a40d6ceb1649611a5dfd119512a9fafa4">m_num_semitransparent_mesh_entries</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">if</span>( num_st1 == num_st2 )</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">return</span> ( num_st1 &gt; num_st2 ) ? 1 : -1;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span>((<a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>)p_mat1 &gt; (<a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>)p_mat2 ) ? 1 : -1;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d4/ddf/namespace_nx_xbox.html#a91b8baea31ab13e2cfc7a29edeccc56d">   84</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a91b8baea31ab13e2cfc7a29edeccc56d">render_instance</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a>* p_instance, <a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> )</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Seed the static pointer off to NULL, otherwise if there is only one object with bone transforms, it will never update.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a56fe2807aa16bdb672be15e2aa6a6812">pLastBoneTransforms</a> = NULL;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span>( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aba834bb3cfcd30127eb37ccbdfe361ac">GetActive</a>())</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a35d72b2c13344c58f8c1541d8a8717d1">set_frustum_bbox_transform</a>( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordtype">bool</span> render = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">if</span>( !( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b">vRENDER_NO_CULLING</a> ))</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="comment">// Check whether this instance is visible.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            render = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a00b7850740ec9a984248e14d78889852">frustum_check_sphere</a>( &amp;p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a3a1bbb641dc0eff6a2dcfd08a7b84735">m_sphere_center</a>, p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a871dd3e456db25552a5a9c1163bf4421">m_sphere_radius</a> ))</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">if</span>( !<a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a7f7272085a93a1646f35a8b304cb7a1a">TestSphereAgainstOccluders</a>( &amp;p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a3a1bbb641dc0eff6a2dcfd08a7b84735">m_sphere_center</a>, p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a871dd3e456db25552a5a9c1163bf4421">m_sphere_radius</a> ))</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    render = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">if</span>( render )</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">if</span>( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>() != NULL )</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a36bff70689365d305755ca6bec7639cc">startup_weighted_mesh_vertex_shader</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#af4f8c3af9a44b5bf9954ed7b93fda4f5">Render</a>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a6383f31ae48f9893e8a216db1c9264ad">vRENDER_OPAQUE</a> | <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a98fec178c2e30a07233f312da65100d3">vRENDER_SEMITRANSPARENT</a> );</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a1c1e2d7613565b14cd823f7640682fdb">shutdown_weighted_mesh_vertex_shader</a>();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#af4f8c3af9a44b5bf9954ed7b93fda4f5">Render</a>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a6383f31ae48f9893e8a216db1c9264ad">vRENDER_OPAQUE</a> | <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a98fec178c2e30a07233f312da65100d3">vRENDER_SEMITRANSPARENT</a> );</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// Restore world transform to identity.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        D3DDevice_SetTransform( D3DTS_WORLD, &amp;<a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a868ea66bba7a5a08a079c35a63768145">world_matrix</a> );</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a35d72b2c13344c58f8c1541d8a8717d1">set_frustum_bbox_transform</a>( NULL );</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="../../d4/ddf/namespace_nx_xbox.html#a89d339689c1b2b21b0c02e078a15aaae">  133</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a89d339689c1b2b21b0c02e078a15aaae">render_instances</a>( <a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> )</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">    #define INSTANCE_ARRAY_SIZE 4096</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keyword">static</span> <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a> *<a class="code" href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">p_instances</a>[INSTANCE_ARRAY_SIZE];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../da/d63/namespace_nx_ngc.html#a295bf3c80cff21498c12ee374c043600">current_index</a> = 0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="../../d9/d37/class_mth_1_1_matrix.html">Mth::Matrix</a> t;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    t.<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#adebc1381b71e980c126cc82aafb8b9fe">Identity</a>();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// Seed the static pointer off to NULL, otherwise if there is only one object with bone transforms, it will never update.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a56fe2807aa16bdb672be15e2aa6a6812">pLastBoneTransforms</a> = NULL;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// First go through and build a list of the visible instances.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a> *p_instance = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a03defcc333dc4dae5c05914d0a7b02bd">pFirstInstance</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">while</span>( p_instance )</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span>( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aba834bb3cfcd30127eb37ccbdfe361ac">GetActive</a>())</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment">// Check to see whether this instance is of the type we want to render - opaque or semitransparent.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">if</span>((( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a6383f31ae48f9893e8a216db1c9264ad">vRENDER_OPAQUE</a> ) &amp;&amp; ( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#abdf14b2a7484a3bcce0d68ec0c18a3f9">m_num_mesh_entries</a> &gt; p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a40d6ceb1649611a5dfd119512a9fafa4">m_num_semitransparent_mesh_entries</a> )) ||</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;               (( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a98fec178c2e30a07233f312da65100d3">vRENDER_SEMITRANSPARENT</a> ) &amp;&amp; ( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a40d6ceb1649611a5dfd119512a9fafa4">m_num_semitransparent_mesh_entries</a> &gt; 0 )))</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="comment">// Check whether this instance is visible - if so, place it in the visible array.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                t.<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a019eca0aefed8bdfd54629c6dfcc81fb">SetPos</a>( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">GetPos</a>());</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a35d72b2c13344c58f8c1541d8a8717d1">set_frustum_bbox_transform</a>( &amp;t );</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="comment">// For skinned objects, we have no idea how the skeleton transforms will be affecting the final position of each object.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="comment">// This can sometimes result in small objects getting culled incorrectly. For these objects, increase the size of</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="comment">// the bounding sphere slightly.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordtype">float</span> radius = p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a871dd3e456db25552a5a9c1163bf4421">m_sphere_radius</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">if</span>( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>() &amp;&amp; ( p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a91cf038b863ac04e4ae109b972b761bb">m_numHierarchyObjects</a> == 0 ))</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    radius = ( radius &lt; 72.0f ) ? 72.0f : radius;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <span class="comment">// The logic code already sets the active flag based on visibility, so there is no need to perform a second visibility check</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <span class="comment">// at this point.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="comment">// We do, however, want to test against occluders.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keywordflow">if</span>( !<a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a7f7272085a93a1646f35a8b304cb7a1a">TestSphereAgainstOccluders</a>( &amp;p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a3a1bbb641dc0eff6a2dcfd08a7b84735">m_sphere_center</a>, radius ))</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    Dbg_Assert( <a class="code" href="../../da/d63/namespace_nx_ngc.html#a295bf3c80cff21498c12ee374c043600">current_index</a> &lt; INSTANCE_ARRAY_SIZE );</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <a class="code" href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">p_instances</a>[<a class="code" href="../../da/d63/namespace_nx_ngc.html#a295bf3c80cff21498c12ee374c043600">current_index</a>++] = p_instance;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        p_instance = p_instance-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a43b124443ceaec12d41c57830fe48f7d">GetNextInstance</a>();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// Now sort the list based on bone transform and number of semitransparent objects in scene.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="../../da/d63/namespace_nx_ngc.html#a295bf3c80cff21498c12ee374c043600">current_index</a> &gt; 0 )</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        qsort( <a class="code" href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">p_instances</a>, <a class="code" href="../../da/d63/namespace_nx_ngc.html#a295bf3c80cff21498c12ee374c043600">current_index</a>, <span class="keyword">sizeof</span>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a>* ), <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#afa8181f7caa5481d0a0b5bcc6c0112e2">sort_by_bone_transform</a> );</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">// First render the instances with bone transforms.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a36bff70689365d305755ca6bec7639cc">startup_weighted_mesh_vertex_shader</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">for</span>( ; i &lt; <a class="code" href="../../da/d63/namespace_nx_ngc.html#a295bf3c80cff21498c12ee374c043600">current_index</a>; ++i )</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">if</span>(( <a class="code" href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">p_instances</a>[i]-&gt;GetBoneTransforms() == NULL ) || ( <a class="code" href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">p_instances</a>[i]-&gt;GetScene()-&gt;m_numHierarchyObjects &gt; 0 ))</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">if</span>(( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a6383f31ae48f9893e8a216db1c9264ad">vRENDER_OPAQUE</a> ) || (( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a98fec178c2e30a07233f312da65100d3">vRENDER_SEMITRANSPARENT</a> ) &amp;&amp; ( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5af401660c888c1e214ba6e9f31fd20ede">vRENDER_INSTANCE_PRE_WORLD_SEMITRANSPARENT</a> )))</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <a class="code" href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">p_instances</a>[i]-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#af4f8c3af9a44b5bf9954ed7b93fda4f5">Render</a>( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> );</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a1c1e2d7613565b14cd823f7640682fdb">shutdown_weighted_mesh_vertex_shader</a>();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">// Then the instances with no bone transforms. These will require fixed function lighting.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        D3DDevice_SetRenderState( D3DRS_LIGHTING,               TRUE );</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        D3DDevice_SetRenderState( D3DRS_COLORVERTEX,            TRUE );</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        D3DDevice_LightEnable( 0, TRUE );</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        D3DDevice_LightEnable( 1, TRUE );</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="../../d1/d08/class_mth_1_1_vector.html">Mth::Vector</a> current_cam_pos( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8b8810bf61e9567bc4c961c8e6985759">cam_position</a>.x, <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8b8810bf61e9567bc4c961c8e6985759">cam_position</a>.y, <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8b8810bf61e9567bc4c961c8e6985759">cam_position</a>.z );</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment">// Get the (square of) the distance at which env mapping will be disabled, in inches.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordtype">float</span> env_map_disable_distance  = <a class="code" href="../../d1/d54/namespace_script.html#a1ef6ac6b15ddd2fcff21e6a3dd6e5938">Script::GetFloat</a>( CRCD( 0x4e7dc608, <span class="stringliteral">&quot;EnvMapDisableDistance&quot;</span>)) * 12.0f;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        env_map_disable_distance        = env_map_disable_distance * env_map_disable_distance;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">for</span>( ; i &lt; <a class="code" href="../../da/d63/namespace_nx_ngc.html#a295bf3c80cff21498c12ee374c043600">current_index</a>; ++i )</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">// Calculate the distance from the current camera to the instance.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordtype">float</span> dist_squared = <a class="code" href="../../d5/db9/namespace_mth.html#a4829497c960aa6d670291025162364d0">Mth::DistanceSqr</a>( <a class="code" href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">p_instances</a>[i]-&gt;GetTransform()-&gt;<a class="code" href="../../dd/df4/matrix_8h.html#ad393a55b0cd17b6dea798c49863e8de4">GetPos</a>(), current_cam_pos );</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">// At forty feet, environment mapping is turned off.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8585f18012329ccc8c41cdf603f11d3d">allow_envmapping</a> = ( dist_squared &gt; env_map_disable_distance ) ? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">if</span>(( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a6383f31ae48f9893e8a216db1c9264ad">vRENDER_OPAQUE</a> ) || (( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a98fec178c2e30a07233f312da65100d3">vRENDER_SEMITRANSPARENT</a> ) &amp;&amp; ( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> &amp; <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5ab94d941829dcdef2e7ac21aacc218fdb">vRENDER_INSTANCE_POST_WORLD_SEMITRANSPARENT</a> )))</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <a class="code" href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">p_instances</a>[i]-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#af4f8c3af9a44b5bf9954ed7b93fda4f5">Render</a>( <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> );</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">// Restore environment mapping..</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8585f18012329ccc8c41cdf603f11d3d">allow_envmapping</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">// Shut down fixed function lighting.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        D3DDevice_SetRenderState( D3DRS_LIGHTING,               FALSE );</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        D3DDevice_SetRenderState( D3DRS_COLORVERTEX,            FALSE );</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        D3DDevice_LightEnable( 0, FALSE );</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        D3DDevice_LightEnable( 1, FALSE );</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// Restore world transform to identity.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    D3DDevice_SetTransform( D3DTS_WORLD, &amp;<a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a868ea66bba7a5a08a079c35a63768145">world_matrix</a> );</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a35d72b2c13344c58f8c1541d8a8717d1">set_frustum_bbox_transform</a>( NULL );</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a93f01d1089d37e45a156db2c20bd1515">  245</a></span>&#160;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a93f01d1089d37e45a156db2c20bd1515">CInstance::CInstance</a>( <a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html">sScene</a> *pScene, <a class="code" href="../../d9/d37/class_mth_1_1_matrix.html">Mth::Matrix</a> &amp;transform, <span class="keywordtype">int</span> numBones, <a class="code" href="../../d9/d37/class_mth_1_1_matrix.html">Mth::Matrix</a> *pBoneTransforms )</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a3ec58f46c4866090bba39c984b11c91d">SetTransform</a>( transform );</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ac36fb431fffccf2b05285166c498e3d6">mp_bone_transforms</a>  = pBoneTransforms;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a9a4be1c771d5f34601f59e6d59487782">m_num_bones</a>         = numBones;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ace4a79ce6d0cd03e19b605cadb821ea7">mp_scene</a>            = pScene;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a523b920ab558306906f16bbda174bb5b">mp_model</a>            = NULL;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a9bd96f5d844699b85f4c18b62bfe9833">m_active</a>            = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">m_flags</a>             = 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ac3a82d55d5971bfff1b049d6aa73f4f9">mp_next_instance</a>    = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a03defcc333dc4dae5c05914d0a7b02bd">pFirstInstance</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a03defcc333dc4dae5c05914d0a7b02bd">pFirstInstance</a>      = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// Check to see whether this instance is allowed to be lit or not (for non-skinned instances).</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// Currently, we assume that instances with a model containing valid normals requires lighting, except in the</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// situation where that model contains a mesh specifically flagged not to be lit.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span>(( pBoneTransforms == NULL ) || ( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;m_numHierarchyObjects &gt; 0 ))</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> m = 0; m &lt; pScene-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#abdf14b2a7484a3bcce0d68ec0c18a3f9">m_num_mesh_entries</a>; ++m )</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html">NxXbox::sMesh</a> *p_mesh = pScene-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a1d262cf8d090a7c21d8176d3c1cea899">m_meshes</a>[m];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">if</span>(( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a14e9f854d177056042f3a9353aa5faae">m_vertex_shader</a>[0] &amp; D3DFVF_NORMAL ) == 0 )</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">if</span>( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#ace52a2342a88f178553e80c84b821199">m_flags</a> &amp; <a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a833e140d6c8bcfad615ed65e2813681aa11f06c9a4885d4d144b8694cb17142c0">sMesh::MESH_FLAG_UNLIT</a> )</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">m_flags</a> |= <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a862f5cbcc2b9cf9d68907675f5957eb4a74e5b5d59eafaffa1f0497fbfb93a90f">CInstance::INSTANCE_FLAG_LIGHTING_ALLOWED</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5659529288c63eb0357f0d7e916dc7b2">  281</a></span>&#160;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5659529288c63eb0357f0d7e916dc7b2">CInstance::~CInstance</a>()</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">m_flags</a> &amp; <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a862f5cbcc2b9cf9d68907675f5957eb4a161baec83a14f9894093ac490bf60963">INSTANCE_FLAG_DELETE_ATTACHED_SCENE</a> )</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ace4a79ce6d0cd03e19b605cadb821ea7">mp_scene</a> )</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keyword">delete</span> <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ace4a79ce6d0cd03e19b605cadb821ea7">mp_scene</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ace4a79ce6d0cd03e19b605cadb821ea7">mp_scene</a> = NULL;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// Remove this instance from the list.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">CInstance</a> **pp_instance = &amp;<a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a03defcc333dc4dae5c05914d0a7b02bd">pFirstInstance</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">while</span>( *pp_instance )</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">if</span>( *pp_instance == <span class="keyword">this</span> )</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            *pp_instance = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ac3a82d55d5971bfff1b049d6aa73f4f9">mp_next_instance</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            pp_instance = &amp;(( *pp_instance )-&gt;mp_next_instance );</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">/*                                                                */</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">/******************************************************************/</span></div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#af4f8c3af9a44b5bf9954ed7b93fda4f5">  314</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#af4f8c3af9a44b5bf9954ed7b93fda4f5">CInstance::Render</a>( <a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> )</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>           MAX_SUPPORTED_BONES = 58;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">float</span>        root_matrix[12];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keyword">static</span> D3DLIGHT8 l0 =</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        D3DLIGHT_DIRECTIONAL,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        { 0.0f, 0.0f, 0.0f, 1.0f }, <span class="comment">// Diffuse color</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        { 1.0f, 1.0f, 1.0f, 0.0f }, <span class="comment">// Specular color</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        { 0.0f, 0.0f, 0.0f, 0.0f }, <span class="comment">// Ambient color</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        { 0.0f, 0.0f, 0.0f },       <span class="comment">// Position</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        { 0.0f, 0.0f, 0.0f },       <span class="comment">// Direction</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        0.0f, 0.0f,                 <span class="comment">// Range, falloff</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        0.0f, 0.0f, 0.0f,           <span class="comment">// Attenuation0, 1, 2</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        0.0f, 0.0f                  <span class="comment">// Theta, Phi</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    };</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">static</span> D3DLIGHT8 l1 =</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        D3DLIGHT_DIRECTIONAL,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        { 0.0f, 0.0f, 0.0f, 1.0f }, <span class="comment">// Diffuse color</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        { 0.0f, 0.0f, 0.0f, 0.0f }, <span class="comment">// Specular color</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        { 0.0f, 0.0f, 0.0f, 0.0f }, <span class="comment">// Ambient color</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        { 0.0f, 0.0f, 0.0f },       <span class="comment">// Position</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        { 0.0f, 0.0f, 0.0f },       <span class="comment">// Direction</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        0.0f, 0.0f,                 <span class="comment">// Range, falloff</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        0.0f, 0.0f, 0.0f,           <span class="comment">// Attenuation0, 1, 2</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        0.0f, 0.0f                  <span class="comment">// Theta, Phi</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    };</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span>(( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>() == NULL ) || ( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;m_numHierarchyObjects &gt; 0 ))</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="comment">// Is a non-skinned object.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a56fe2807aa16bdb672be15e2aa6a6812">pLastBoneTransforms</a> = NULL;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// Do the lighting setup here.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span>((( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">m_flags</a> &amp; <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a862f5cbcc2b9cf9d68907675f5957eb4a74e5b5d59eafaffa1f0497fbfb93a90f">CInstance::INSTANCE_FLAG_LIGHTING_ALLOWED</a> ) == 0 ) || ( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">m_flags</a> &amp; SCENE_FLAG_RENDERING_SHADOW ))</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            D3DDevice_SetRenderState( D3DRS_LIGHTING, FALSE );</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <a class="code" href="../../d2/d32/class_nx_1_1_c_model_lights.html">Nx::CModelLights</a> *p_lights = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a255bf2960f8ecde01b8fe5d227fdbf83">GetModel</a>() ? <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a255bf2960f8ecde01b8fe5d227fdbf83">GetModel</a>()-&gt;<a class="code" href="../../d0/dea/class_nx_1_1_c_model.html#a99f6c91e9c8cb1e752d8b9cf251aa49c">GetModelLights</a>() : NULL;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">if</span>( p_lights )</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="comment">// Obtain position from the transform, for calculating Scene Lighting.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                p_lights-&gt;<a class="code" href="../../d2/d32/class_nx_1_1_c_model_lights.html#afde283dbcaa3613474550bd422fcd7f6">UpdateEngine</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../dd/df4/matrix_8h.html#ad393a55b0cd17b6dea798c49863e8de4">GetPos</a>(), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <a class="code" href="../../d9/d46/class_nx_1_1_c_light_manager.html#aba013f530e33da6c741cc368ac92dae0">Nx::CLightManager::sUpdateEngine</a>();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            D3DDevice_SetRenderState( D3DRS_LIGHTING, TRUE );</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            l0.Diffuse.r    = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[4];</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            l0.Diffuse.g    = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[5];</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            l0.Diffuse.b    = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[6];</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            l0.Direction.x  = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[0];</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            l0.Direction.y  = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[1];</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            l0.Direction.z  = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[2];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            D3DDevice_SetLight( 0, &amp;l0 );</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            l1.Diffuse.r    = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[12];</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            l1.Diffuse.g    = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[13];</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            l1.Diffuse.b    = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[14];</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            l1.Direction.x  = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[8];</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            l1.Direction.y  = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[9];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            l1.Direction.z  = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">directional_light_color</a>[10];</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            D3DDevice_SetLight( 1, &amp;l1 );</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            D3DDevice_SetRenderState( D3DRS_AMBIENT, D3DCOLOR_RGBA( <a class="code" href="../../da/d49/sse_8h.html#ae53e225bb0869de34215f031b7fdaa57">Ftoi_ASM</a>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a35a143572a74a014525185af4a7759e6">ambient_light_color</a>[0] * 255.0f ),</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                                                    <a class="code" href="../../da/d49/sse_8h.html#ae53e225bb0869de34215f031b7fdaa57">Ftoi_ASM</a>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a35a143572a74a014525185af4a7759e6">ambient_light_color</a>[1] * 255.0f ),</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                                                    <a class="code" href="../../da/d49/sse_8h.html#ae53e225bb0869de34215f031b7fdaa57">Ftoi_ASM</a>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a35a143572a74a014525185af4a7759e6">ambient_light_color</a>[2] * 255.0f ),</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                                                    0xFF ));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// If the object has a &#39;fake skeleton&#39;, like the cars with rotating wheels, then set up accordingly.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;m_numHierarchyObjects )</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordtype">int</span> num_bones = ( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa14da24ee9bc1b122fd451bd00a00207">GetNumBones</a>() &lt; MAX_SUPPORTED_BONES ) ? <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa14da24ee9bc1b122fd451bd00a00207">GetNumBones</a>() : MAX_SUPPORTED_BONES;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> lp = 0; lp &lt; num_bones; ++lp )</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <a class="code" href="../../d9/d37/class_mth_1_1_matrix.html">Mth::Matrix</a> temp = *<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                temp = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>()[lp] * temp;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a35d72b2c13344c58f8c1541d8a8717d1">set_frustum_bbox_transform</a>( &amp;temp );</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                D3DDevice_SetTransform( D3DTS_WORLD, (D3DXMATRIX*)&amp;temp );</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="comment">// Scan through the meshes, setting only those with the current bone active.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">for</span>( <span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#abdf14b2a7484a3bcce0d68ec0c18a3f9">m_num_mesh_entries</a>; ++m )</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    <a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html">NxXbox::sMesh</a> *p_mesh = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a1d262cf8d090a7c21d8176d3c1cea899">m_meshes</a>[m];</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    <span class="keywordflow">if</span>( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#aae00671dc054b7acee28341365412693">GetBoneIndex</a>() == lp )</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a3c564a178aec4091e87cd7b127cb4ef2">SetActive</a>( <span class="keyword">true</span> );</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a3c564a178aec4091e87cd7b127cb4ef2">SetActive</a>( <span class="keyword">false</span> );</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#aeea1e1820132824403fc768475ceb9bd">render_scene</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>(), <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> | <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b">vRENDER_NO_CULLING</a> );</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="comment">// Has no skeleton.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a35d72b2c13344c58f8c1541d8a8717d1">set_frustum_bbox_transform</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>());</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            D3DDevice_SetTransform( D3DTS_WORLD, (D3DXMATRIX*)<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>());</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#aeea1e1820132824403fc768475ceb9bd">render_scene</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>(), <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> | <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b">vRENDER_NO_CULLING</a> );</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">// Has bone transforms, is therefore an animated object such as a skater, pedestrian etc.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a35d72b2c13344c58f8c1541d8a8717d1">set_frustum_bbox_transform</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">// We only want to upload all the bone transforms if they have changed from the last call.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordtype">bool</span> upload_bone_transforms = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a56fe2807aa16bdb672be15e2aa6a6812">pLastBoneTransforms</a> != <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>())</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="comment">// Okay, the bone transforms have changed from the last call.</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            upload_bone_transforms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="comment">// Do the lighting setup here (if not rendering shadow, which requires no lighting).</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordflow">if</span>(( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">m_flags</a> &amp; SCENE_FLAG_RENDERING_SHADOW ) == 0 )</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <a class="code" href="../../d2/d32/class_nx_1_1_c_model_lights.html">Nx::CModelLights</a> *p_lights = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a255bf2960f8ecde01b8fe5d227fdbf83">GetModel</a>() ? <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a255bf2960f8ecde01b8fe5d227fdbf83">GetModel</a>()-&gt;<a class="code" href="../../d0/dea/class_nx_1_1_c_model.html#a99f6c91e9c8cb1e752d8b9cf251aa49c">GetModelLights</a>() : NULL;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="keywordflow">if</span>( p_lights )</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    p_lights-&gt;<a class="code" href="../../d2/d32/class_nx_1_1_c_model_lights.html#afde283dbcaa3613474550bd422fcd7f6">UpdateEngine</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../dd/df4/matrix_8h.html#ad393a55b0cd17b6dea798c49863e8de4">GetPos</a>(), <span class="keyword">true</span> );</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    <a class="code" href="../../d9/d46/class_nx_1_1_c_light_manager.html#aba013f530e33da6c741cc368ac92dae0">Nx::CLightManager::sUpdateEngine</a>();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a56fe2807aa16bdb672be15e2aa6a6812">pLastBoneTransforms</a> = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordtype">int</span> num_bones = ( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa14da24ee9bc1b122fd451bd00a00207">GetNumBones</a>() &lt; MAX_SUPPORTED_BONES ) ? <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa14da24ee9bc1b122fd451bd00a00207">GetNumBones</a>() : MAX_SUPPORTED_BONES;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        root_matrix[0]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a84f51ecd28902b7c9fccd38fdae1ad85">GetRight</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>];</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        root_matrix[1]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a20cd2a0264b2acbaea886a0387477a3f">GetUp</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>];</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        root_matrix[2]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a66d839b730e37ef73b1dff15edebd754">GetAt</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>];</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        root_matrix[3]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">GetPos</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>];</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        root_matrix[4]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a84f51ecd28902b7c9fccd38fdae1ad85">GetRight</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a>];</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        root_matrix[5]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a20cd2a0264b2acbaea886a0387477a3f">GetUp</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a>];</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        root_matrix[6]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a66d839b730e37ef73b1dff15edebd754">GetAt</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a>];</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        root_matrix[7]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">GetPos</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a>];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        root_matrix[8]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a84f51ecd28902b7c9fccd38fdae1ad85">GetRight</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a>];</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        root_matrix[9]  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a20cd2a0264b2acbaea886a0387477a3f">GetUp</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a>];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        root_matrix[10] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a66d839b730e37ef73b1dff15edebd754">GetAt</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a>];</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        root_matrix[11] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">GetPos</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a>];</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a8a8933b9aa8ad3f8ddbbd2ed59329fd2">setup_weighted_mesh_vertex_shader</a>( &amp;root_matrix, &amp;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>()[0][<a class="code" href="../../d5/db9/namespace_mth.html#a7b9b1c529db03b284ac3fce278234cc2a56d801d6c06dea10a9a31e21da362bef">Mth::RIGHT</a>][<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>], upload_bone_transforms ? <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa14da24ee9bc1b122fd451bd00a00207">GetNumBones</a>() : 0 );</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">m_flags</a> &amp; SCENE_FLAG_RENDERING_SHADOW )</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="comment">// Set the simple vertex shader that does no normal transform or lighting.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a26eda17b0f46b5f5b914f683b8af7e77">set_vertex_shader</a>( <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#ad2ab4bdb61c8f0f00039d14ed45644f5">WeightedMeshVertexShader_SBWrite</a> );</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a34c0a95d57d46baff53420aa353d0f12">vertex_shader_override</a> = 1;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="comment">// Set the simple pixel shader that just writes constant (1,1,1,1) out.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a7ab2d41a1053bd29a3a2c75c04983c56">set_pixel_shader</a>( <a class="code" href="../../d2/dad/_x_box_2_n_x_2render_8cpp.html#a6cc9a2457d968232a1d91150cb5a4c62">PixelShaderNULL</a> );</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a4fac7b6f6cf022b9aed58d542cf8be72">pixel_shader_override</a> = 1;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="comment">// No backface culling.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af169397368451c254aef09298bec304a">set_render_state</a>( RS_CULLMODE, D3DCULL_NONE );</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="comment">// Lock out material changes.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a36a8aed54dca98c4e17ba501f57665cb">material_override</a> = 1;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#aeea1e1820132824403fc768475ceb9bd">render_scene</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>(), <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> | <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b">vRENDER_NO_CULLING</a> );</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">//          RenderShadowVolume();</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#aeea1e1820132824403fc768475ceb9bd">render_scene</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>(), <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> | <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b">vRENDER_NO_CULLING</a> );</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="comment">// Render the self-shadowing pass here, if so flagged.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>()-&gt;<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">m_flags</a> &amp; SCENE_FLAG_SELF_SHADOWS )</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keyword">static</span> <span class="keywordtype">float</span> texture_projection_matrix[16];</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="comment">// Calculate distance to the camera - the self shadowing fades out beyond a certain distance, (and also fades out</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <span class="comment">// close up, to avoid the visible streaks). Also need to take into account the view angle since that directly affects</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <span class="comment">// the relative screen space size of the object.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> SHADOW_FADE_CLOSE_START         = 150.0f;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> SHADOW_FADE_CLOSE_COMPLETE      = 120.0f;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> SHADOW_FADE_FAR_START           = 500.0f;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> SHADOW_FADE_FAR_COMPLETE        = 600.0f;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> DEFAULT_SCREEN_ANGLE            = 0.72654f; <span class="comment">// tan( 72 / 2 )</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <a class="code" href="../../d1/d08/class_mth_1_1_vector.html">Mth::Vector</a> pos_to_cam  = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">GetPos</a>() - <a class="code" href="../../d6/d68/vector_8h.html#a97b62c44fa0ff9823c90a7588a9627c0">Mth::Vector</a>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.cam_position.x, <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8b8810bf61e9567bc4c961c8e6985759">cam_position</a>.y, <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8b8810bf61e9567bc4c961c8e6985759">cam_position</a>.z );</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="keywordtype">float</span>       dist        = pos_to_cam.<a class="code" href="../../d1/d08/class_mth_1_1_vector.html#a88ad2190dc8bba653fc442dfed7c033a">Length</a>() * ( tanf( <a class="code" href="../../d5/db9/namespace_mth.html#a5a88e8aff5b7bdd63a88cd62c1485814">Mth::DegToRad</a>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a14181f821d1aaf7263b61814cb268d35">screen_angle</a> * 0.5f )) / DEFAULT_SCREEN_ANGLE );</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="keywordflow">if</span>(( dist &gt; SHADOW_FADE_CLOSE_COMPLETE ) &amp;&amp; ( dist &lt; SHADOW_FADE_FAR_COMPLETE ))</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    <span class="comment">// Find which set of details relates to this instance.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a6d6adf40e13d0f60762fdd5e87eaf8c8">pTextureProjectionDetailsTable</a>-&gt;IterateStart();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    <a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html">sTextureProjectionDetails</a> *p_details = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a6d6adf40e13d0f60762fdd5e87eaf8c8">pTextureProjectionDetailsTable</a>-&gt;IterateNext();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    <span class="keywordflow">while</span>( p_details )</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                        <span class="keywordflow">if</span>( p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a7a451ab2fb158c5b3154b07b12a593d9">p_model</a> == <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a523b920ab558306906f16bbda174bb5b">mp_model</a> )</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        p_details = <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a6d6adf40e13d0f60762fdd5e87eaf8c8">pTextureProjectionDetailsTable</a>-&gt;IterateNext();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                    <span class="keywordflow">if</span>( p_details )</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <span class="comment">// Need to incorporate the world matrix into the texture projection matrix, since we will be using the bone-transformed</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        <span class="comment">// vertex positions, which are in object space.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        XGMATRIX world_matrix;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        world_matrix.m[0][0] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a84f51ecd28902b7c9fccd38fdae1ad85">GetRight</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>];</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        world_matrix.m[0][1] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a84f51ecd28902b7c9fccd38fdae1ad85">GetRight</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a>];</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                        world_matrix.m[0][2] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a84f51ecd28902b7c9fccd38fdae1ad85">GetRight</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a>];</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        world_matrix.m[0][3] = 0.0f;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                        world_matrix.m[1][0] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a20cd2a0264b2acbaea886a0387477a3f">GetUp</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>];</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        world_matrix.m[1][1] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a20cd2a0264b2acbaea886a0387477a3f">GetUp</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a>];</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        world_matrix.m[1][2] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a20cd2a0264b2acbaea886a0387477a3f">GetUp</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a>];</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        world_matrix.m[1][3] = 0.0f;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        world_matrix.m[2][0] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a66d839b730e37ef73b1dff15edebd754">GetAt</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>];</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        world_matrix.m[2][1] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a66d839b730e37ef73b1dff15edebd754">GetAt</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a>];</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                        world_matrix.m[2][2] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a66d839b730e37ef73b1dff15edebd754">GetAt</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a>];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        world_matrix.m[2][3] = 0.0f;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        world_matrix.m[3][0] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">GetPos</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a>];</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        world_matrix.m[3][1] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">GetPos</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a>];</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        world_matrix.m[3][2] = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>()-&gt;<a class="code" href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">GetPos</a>()[<a class="code" href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a>];</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                        world_matrix.m[3][3] = 1.0f;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#adfb13f2062cc0478360f8179ba1704bb">calculate_tex_proj_matrix</a>( &amp;p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a952b60b67e9e03aeb25aa82ebaa3896d">view_matrix</a>, &amp;p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a4d43b3bba32c77e83982dd56eeba5090">projection_matrix</a>, &amp;p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>, &amp;world_matrix );</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        <span class="comment">// Upload that matrix to the GPU also.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                        texture_projection_matrix[0]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[0][0];</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        texture_projection_matrix[1]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[1][0];</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                        texture_projection_matrix[2]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[2][0];</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        texture_projection_matrix[3]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[3][0];</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        texture_projection_matrix[4]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[0][1];</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        texture_projection_matrix[5]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[1][1];</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                        texture_projection_matrix[6]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[2][1];</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        texture_projection_matrix[7]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[3][1];</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        texture_projection_matrix[8]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[0][2];</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                        texture_projection_matrix[9]    = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[1][2];</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        texture_projection_matrix[10]   = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[2][2];</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                        texture_projection_matrix[11]   = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[3][2];</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        texture_projection_matrix[12]   = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[0][3];</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        texture_projection_matrix[13]   = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[1][3];</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                        texture_projection_matrix[14]   = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[2][3];</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                        texture_projection_matrix[15]   = p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">texture_projection_matrix</a>.m[3][3];</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                        <span class="comment">// We can upload this matrix to the space taken up by the directional lighting details, since this render pass requires no lighting.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                        D3DDevice_SetVertexShaderConstantFast( VSCONST_REG_DIR_LIGHT_OFFSET, (<span class="keywordtype">void</span>*)texture_projection_matrix, 4 );</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        <span class="comment">// Scan through each mesh in this scene, setting the vertex shader to be the equivalent vertex shader</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                        <span class="comment">// for shadow buffering.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                        <a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html">sScene</a> *p_scene = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> m = 0; m &lt; p_scene-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#abdf14b2a7484a3bcce0d68ec0c18a3f9">m_num_mesh_entries</a>; ++m )</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                        {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                            <a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html">sMesh</a> *p_mesh = p_scene-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a1d262cf8d090a7c21d8176d3c1cea899">m_meshes</a>[m];</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                            <span class="keywordflow">if</span>(( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a14e9f854d177056042f3a9353aa5faae">m_vertex_shader</a>[0] == <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#a1d2462a15786553fa77791368bba253f">WeightedMeshVS_VXC_1Weight</a> ) ||</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                               ( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a14e9f854d177056042f3a9353aa5faae">m_vertex_shader</a>[0] == <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#ad76ed24b02f2201fe7b2f6bfe458f33a">WeightedMeshVS_VXC_Specular_1Weight</a> ) ||</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                               ( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a14e9f854d177056042f3a9353aa5faae">m_vertex_shader</a>[0] == <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#aa847e04dafb23b89de4f817af909f495">WeightedMeshVS_VXC_1Weight_UVTransform</a> ))</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                            {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a267e786eecc45a749f6b84c4c5d6384b">PushVertexShader</a>( <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#a4274b62ba49181cfa2714c64c2459850">WeightedMeshVS_VXC_1Weight_SBPassThru</a> );</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                            }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a14e9f854d177056042f3a9353aa5faae">m_vertex_shader</a>[0] == <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#ac5e7dc241351e483fad6056c8a92aedb">WeightedMeshVS_VXC_2Weight</a> ) ||</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                    ( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a14e9f854d177056042f3a9353aa5faae">m_vertex_shader</a>[0] == <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#a88d92011d056439b7de12577f787e27a">WeightedMeshVS_VXC_Specular_2Weight</a> ) ||</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                    ( p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a14e9f854d177056042f3a9353aa5faae">m_vertex_shader</a>[0] == <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#afa785034898e6c626fdbfe5d2b18094d">WeightedMeshVS_VXC_2Weight_UVTransform</a> ))</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                            {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                                p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a267e786eecc45a749f6b84c4c5d6384b">PushVertexShader</a>( <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#ae70dcaf5276679e8c417aff141604cdb">WeightedMeshVS_VXC_2Weight_SBPassThru</a> );</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                            }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                            {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a267e786eecc45a749f6b84c4c5d6384b">PushVertexShader</a>( <a class="code" href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#a3d8adada4894450d9bc781db82151026">WeightedMeshVS_VXC_3Weight_SBPassThru</a> );</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                            }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                        }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                        <span class="keywordtype">float</span> <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a> = 0.25f;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                        <span class="keywordflow">if</span>( dist &lt; SHADOW_FADE_CLOSE_START )</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                            <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a> = (( dist - SHADOW_FADE_CLOSE_COMPLETE ) / ( SHADOW_FADE_CLOSE_START - SHADOW_FADE_CLOSE_COMPLETE )) * <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                        }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( dist &gt; SHADOW_FADE_FAR_START )</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                            <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a> = (( SHADOW_FADE_FAR_COMPLETE - dist ) / ( SHADOW_FADE_FAR_COMPLETE - SHADOW_FADE_FAR_START )) * <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                        }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        <span class="comment">// Set ambient color multipliers in pixel shader C0 and C1.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">pixel_shader_constants</a>[0]     = 1.0f - <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a>;       <span class="comment">// Always present</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">pixel_shader_constants</a>[1]     = 1.0f - <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">pixel_shader_constants</a>[2]     = 1.0f - <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">pixel_shader_constants</a>[3]     = 1.0f;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">pixel_shader_constants</a>[4]     = <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a>;      <span class="comment">// The part the shadow affects.</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">pixel_shader_constants</a>[5]     = <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">pixel_shader_constants</a>[6]     = <a class="code" href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">max</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">pixel_shader_constants</a>[7]     = 1.0f;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a4295cb5e56a5fcd425f82e66950858a4">upload_pixel_shader_constants</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                        <span class="comment">// Set the pixel shader that will do the shadow attenuation.            </span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                        <span class="keyword">extern</span> DWORD <a class="code" href="../../d2/dad/_x_box_2_n_x_2render_8cpp.html#aee030a275c0b85f7a3edf1c8ff8ba4c3">PixelShader_ShadowBuffer</a>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a7ab2d41a1053bd29a3a2c75c04983c56">set_pixel_shader</a>( <a class="code" href="../../d2/dad/_x_box_2_n_x_2render_8cpp.html#aee030a275c0b85f7a3edf1c8ff8ba4c3">PixelShader_ShadowBuffer</a> );</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a4fac7b6f6cf022b9aed58d542cf8be72">pixel_shader_override</a> = 1;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        <span class="comment">// Set the material properties used for shadow modulation.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#a01e96222a8aac875c17a870a36d1d965">set_blend_mode</a>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af9a41b989a910a00f7578e5ffe8f8529a20e63872b54017adbaffb3add7950867">vBLEND_MODE_MODULATE_COLOR</a> );</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#abc37345517638e477d4e5ebde2044ac9">set_texture</a>( 0, NULL );</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#abc37345517638e477d4e5ebde2044ac9">set_texture</a>( 1, NULL );</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#abc37345517638e477d4e5ebde2044ac9">set_texture</a>( 2, NULL );</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a36a8aed54dca98c4e17ba501f57665cb">material_override</a> = 1;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        <span class="comment">// Set texture stage 3 to use the shadow buffer.</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#af28bc0482df30e6a0261cba338c315a1">texture_stage_override</a> |= ( 1 &lt;&lt; 3 );</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#abc37345517638e477d4e5ebde2044ac9">set_texture</a>( 3, NULL );</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#abc37345517638e477d4e5ebde2044ac9">set_texture</a>( 3, p_details-&gt;<a class="code" href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#aab3098e227188d8bd166afd4ce9528f6">p_texture</a>-&gt;<a class="code" href="../../d6/dd9/struct_nx_xbox_1_1s_texture.html#a917fa9f4966c164d234cd05e0a6aedc3">pD3DTexture</a> );</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af169397368451c254aef09298bec304a">set_render_state</a>( RS_UVADDRESSMODE0 + 3, 0x00020002UL );</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        D3DDevice_SetTextureStageState( 3, D3DTSS_BORDERCOLOR, 0x00000000UL );</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        D3DDevice_SetTextureStageState( 3, D3DTSS_MAGFILTER, D3DTEXF_LINEAR );</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        D3DDevice_SetTextureStageState( 3, D3DTSS_MINFILTER, D3DTEXF_LINEAR );</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        D3DDevice_SetTextureStageState( 3, D3DTSS_TEXTURETRANSFORMFLAGS, D3DTTFF_DISABLE );</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                        D3DDevice_SetTextureStageState( 3, D3DTSS_TEXCOORDINDEX, D3DTSS_TCI_PASSTHRU | 3 );</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                        <span class="comment">// Set shadowbuffer state.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        D3DDevice_SetRenderState( D3DRS_SHADOWFUNC, D3DCMP_GREATER );</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                        <span class="comment">// Render the shadow pass with fogging disabled.</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a87919ec057f9c63e3e00be2cab462bcf">fog_enabled</a> )</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                        {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                            D3DDevice_SetRenderState( D3DRS_FOGENABLE, FALSE );</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#aeea1e1820132824403fc768475ceb9bd">render_scene</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>(), <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> | <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b">vRENDER_NO_CULLING</a> );</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                            D3DDevice_SetRenderState( D3DRS_FOGENABLE, TRUE );</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                        }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                        {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                            <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#aeea1e1820132824403fc768475ceb9bd">render_scene</a>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>(), <a class="code" href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">flags</a> | <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b">vRENDER_NO_CULLING</a> );</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                        }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        <span class="comment">// Restore shadowbuffer state.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                        D3DDevice_SetRenderState( D3DRS_SHADOWFUNC, D3DCMP_NEVER );</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                        <span class="comment">// Scan through each mesh in this scene, restoring the vertex shader to the original.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> m = 0; m &lt; p_scene-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#abdf14b2a7484a3bcce0d68ec0c18a3f9">m_num_mesh_entries</a>; ++m )</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                        {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                            <a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html">sMesh</a> *p_mesh = p_scene-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a1d262cf8d090a7c21d8176d3c1cea899">m_meshes</a>[m];</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                            p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a238e8c9dfed99feb2d837fa7cdaf3009">PopVertexShader</a>();</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                        }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="comment">// Restore state.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a34c0a95d57d46baff53420aa353d0f12">vertex_shader_override</a>    = 0;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a4fac7b6f6cf022b9aed58d542cf8be72">pixel_shader_override</a>     = 0;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a36a8aed54dca98c4e17ba501f57665cb">material_override</a>         = 0;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">EngineGlobals</a>.<a class="code" href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#af28bc0482df30e6a0261cba338c315a1">texture_stage_override</a>    &amp;= ~( 1 &lt;&lt; 3 );</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <a class="code" href="../../d4/ddf/namespace_nx_xbox.html#abc37345517638e477d4e5ebde2044ac9">set_texture</a>( 3, NULL );</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">//      shutdown_weighted_mesh_vertex_shader();</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">// Test code...</span></div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a54878f586bbff3ede56cc29d0ca88fb3">  680</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a54878f586bbff3ede56cc29d0ca88fb3">CInstance::RenderShadowVolume</a>( <span class="keywordtype">void</span> )</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;{</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>())</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        XGMATRIX root_matrix = *((XGMATRIX*)<a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">GetTransform</a>());</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html">sScene</a>* p_scene = <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">GetScene</a>();</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="comment">// Process each mesh in turn.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> m = 0; m &lt; p_scene-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#abdf14b2a7484a3bcce0d68ec0c18a3f9">m_num_mesh_entries</a>; ++m )</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html">sMesh</a>* p_mesh   = p_scene-&gt;<a class="code" href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a1d262cf8d090a7c21d8176d3c1cea899">m_meshes</a>[m];</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="comment">// Lock the vertex buffer so we can read the data.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            BYTE* p_byte;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#af306caaf25a091983b3187e7680ccd3f">mp_vertex_buffer</a>[0]-&gt;Lock( 0, 0, &amp;p_byte, D3DLOCK_READONLY );</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment">// Grab a buffer for the transformed points.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            XGVECTOR4*  p_t_buffer  = <span class="keyword">new</span> XGVECTOR4[p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#aa0780820824923f8bc7ecf5bf1f2bc4b">m_num_vertices</a>];</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> v = 0; v &lt; p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#aa0780820824923f8bc7ecf5bf1f2bc4b">m_num_vertices</a>; ++v )</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                <span class="comment">// Get untransformed point.</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                XGVECTOR3*  p_source_vertex = (XGVECTOR3*)( p_byte + ( v * p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a97f6ad6d5f66fc4279d601fe0cc6c215">m_vertex_stride</a> ));</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                <span class="comment">// Get and unpack weights.</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      packed_weights  = *((<a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>*)( p_byte + ( v * p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a97f6ad6d5f66fc4279d601fe0cc6c215">m_vertex_stride</a> ) + 12 ));</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="keywordtype">float</span>       w0              = (( packed_weights &gt;&gt; 0 ) &amp; 0x7ff ) * ( 1.0f / 1023.0f );</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                <span class="keywordtype">float</span>       w1              = (( packed_weights &gt;&gt; 11 ) &amp; 0x7ff ) * ( 1.0f / 1023.0f );</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                <span class="keywordtype">float</span>       w2              = (( packed_weights &gt;&gt; 22 ) &amp; 0x3ff ) * ( 1.0f / 511.0f );</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <span class="comment">// Get and unpack matrix indices.</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      packed_indices  = *((<a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>*)( p_byte + ( v * p_mesh-&gt;<a class="code" href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a97f6ad6d5f66fc4279d601fe0cc6c215">m_vertex_stride</a> ) + 16 ));</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      i0              = ( packed_indices &gt;&gt; 0 ) &amp; 0xff;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      i1              = ( packed_indices &gt;&gt; 8 ) &amp; 0xff;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <a class="code" href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      i2              = ( packed_indices &gt;&gt; 16 ) &amp; 0xff;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <span class="comment">// Get bone matrix pointers.</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                XGMATRIX*   p_bone_mat0     = (XGMATRIX*)( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>() + i0 );</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                XGMATRIX*   p_bone_mat1     = (XGMATRIX*)( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>() + i1 );</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                XGMATRIX*   p_bone_mat2     = (XGMATRIX*)( <a class="code" href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">GetBoneTransforms</a>() + i2 );</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                XGVECTOR4   tp0;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                XGVECTOR4   tp1;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                XGVECTOR4   tp2;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="comment">// Transform point by bone matrix 0, 1 and 2 and scale with weight 0, 1, 2.</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                XGVec3Transform( &amp;tp0, p_source_vertex, p_bone_mat0 );</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                XGVec3Scale((XGVECTOR3*)&amp;tp0, (XGVECTOR3*)&amp;tp0, w0 );</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                XGVec3Transform( &amp;tp1, p_source_vertex, p_bone_mat1 );</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                XGVec3Scale((XGVECTOR3*)&amp;tp1, (XGVECTOR3*)&amp;tp1, w1 );</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                XGVec3Transform( &amp;tp2, p_source_vertex, p_bone_mat2 );</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                XGVec3Scale((XGVECTOR3*)&amp;tp2, (XGVECTOR3*)&amp;tp2, w2 );</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <span class="comment">// Obtain cumulative result.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                tp0 = tp0 + tp1 + tp2;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <span class="comment">// Tranform point by object transform.</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                XGVec3Transform( p_t_buffer + v, (XGVECTOR3*)&amp;tp0, &amp;root_matrix );</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="keyword">delete</span> [] p_t_buffer;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;} <span class="comment">// namespace NxXbox</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_ad76ed24b02f2201fe7b2f6bfe458f33a"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#ad76ed24b02f2201fe7b2f6bfe458f33a">WeightedMeshVS_VXC_Specular_1Weight</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_Specular_1Weight</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00046">anim.cpp:46</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_aa847e04dafb23b89de4f817af909f495"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#aa847e04dafb23b89de4f817af909f495">WeightedMeshVS_VXC_1Weight_UVTransform</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_1Weight_UVTransform</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00049">anim.cpp:49</a></div></div>
<div class="ttc" id="a_nx_light_8h_html"><div class="ttname"><a href="../../d6/d45/_nx_light_8h.html">NxLight.h</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_adfb13f2062cc0478360f8179ba1704bb"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#adfb13f2062cc0478360f8179ba1704bb">NxXbox::calculate_tex_proj_matrix</a></div><div class="ttdeci">void calculate_tex_proj_matrix(XGMATRIX *p_tex_view_matrix, XGMATRIX *p_tex_proj_matrix, XGMATRIX *p_tex_transform_matrix, XGMATRIX *p_world_matrix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l02074">render.cpp:2074</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_texture_projection_details_html_a4d43b3bba32c77e83982dd56eeba5090"><div class="ttname"><a href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a4d43b3bba32c77e83982dd56eeba5090">NxXbox::sTextureProjectionDetails::projection_matrix</a></div><div class="ttdeci">XGMATRIX projection_matrix</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00056">render.h:56</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a87919ec057f9c63e3e00be2cab462bcf"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a87919ec057f9c63e3e00be2cab462bcf">NxXbox::sEngineGlobals::fog_enabled</a></div><div class="ttdeci">uint32 fog_enabled</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00109">nx_init.h:109</a></div></div>
<div class="ttc" id="aclass_mth_1_1_vector_html_a88ad2190dc8bba653fc442dfed7c033a"><div class="ttname"><a href="../../d1/d08/class_mth_1_1_vector.html#a88ad2190dc8bba653fc442dfed7c033a">Mth::Vector::Length</a></div><div class="ttdeci">float Length(void) const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5f/vector_8inl_source.html#l00398">vector.inl:398</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a36bff70689365d305755ca6bec7639cc"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a36bff70689365d305755ca6bec7639cc">NxXbox::startup_weighted_mesh_vertex_shader</a></div><div class="ttdeci">void startup_weighted_mesh_vertex_shader(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00473">anim.cpp:473</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a9a4be1c771d5f34601f59e6d59487782"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a9a4be1c771d5f34601f59e6d59487782">NxXbox::CInstance::m_num_bones</a></div><div class="ttdeci">int m_num_bones</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00049">instance.h:49</a></div></div>
<div class="ttc" id="anamespace_nx_ngc_html_a54204d3ad8d60f9dd750abf945e3cabd"><div class="ttname"><a href="../../da/d63/namespace_nx_ngc.html#a54204d3ad8d60f9dd750abf945e3cabd">NxNgc::p_instances</a></div><div class="ttdeci">static CInstance * p_instances[INSTANCE_ARRAY_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df7/_n_g_c_2_n_x_2instance_8cpp_source.html#l00079">instance.cpp:79</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_af306caaf25a091983b3187e7680ccd3f"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#af306caaf25a091983b3187e7680ccd3f">NxXbox::sMesh::mp_vertex_buffer</a></div><div class="ttdeci">IDirect3DVertexBuffer8 * mp_vertex_buffer[MAX_VERTEX_BUFFERS]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00142">mesh.h:142</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_ace4a79ce6d0cd03e19b605cadb821ea7"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ace4a79ce6d0cd03e19b605cadb821ea7">NxXbox::CInstance::mp_scene</a></div><div class="ttdeci">sScene * mp_scene</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00052">instance.h:52</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a523b920ab558306906f16bbda174bb5b"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a523b920ab558306906f16bbda174bb5b">NxXbox::CInstance::mp_model</a></div><div class="ttdeci">Nx::CModel * mp_model</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00051">instance.h:51</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a5878e1f1cedc20338a310c9d62d07614"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5878e1f1cedc20338a310c9d62d07614">NxXbox::CInstance::GetBoneTransforms</a></div><div class="ttdeci">Mth::Matrix * GetBoneTransforms(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00028">instance.h:28</a></div></div>
<div class="ttc" id="aclass_mth_1_1_matrix_html_a20cd2a0264b2acbaea886a0387477a3f"><div class="ttname"><a href="../../d9/d37/class_mth_1_1_matrix.html#a20cd2a0264b2acbaea886a0387477a3f">Mth::Matrix::GetUp</a></div><div class="ttdeci">Vector &amp; GetUp(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00124">matrix.h:124</a></div></div>
<div class="ttc" id="anamespace_gfx_html_a3b40fd4213d96987efb02104d0068687"><div class="ttname"><a href="../../de/d47/namespace_gfx.html#a3b40fd4213d96987efb02104d0068687">Gfx::flags</a></div><div class="ttdeci">unsigned char flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d76/_boned_anim_8cpp_source.html#l01996">BonedAnim.cpp:1996</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_scene_html_a3a1bbb641dc0eff6a2dcfd08a7b84735"><div class="ttname"><a href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a3a1bbb641dc0eff6a2dcfd08a7b84735">NxXbox::sScene::m_sphere_center</a></div><div class="ttdeci">D3DXVECTOR3 m_sphere_center</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db8/_x_box_2_n_x_2scene_8h_source.html#l00069">scene.h:69</a></div></div>
<div class="ttc" id="adebuggfx_8h_html"><div class="ttname"><a href="../../d3/d83/debuggfx_8h.html">debuggfx.h</a></div></div>
<div class="ttc" id="a_defines_8h_html_a1134b580f8da4de94ca6b1de4d37975e"><div class="ttname"><a href="../../d8/de2/_defines_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a></div><div class="ttdeci">unsigned long uint32</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de2/_defines_8h_source.html#l00147">Defines.h:147</a></div></div>
<div class="ttc" id="aclass_nx_1_1_c_model_lights_html_afde283dbcaa3613474550bd422fcd7f6"><div class="ttname"><a href="../../d2/d32/class_nx_1_1_c_model_lights.html#afde283dbcaa3613474550bd422fcd7f6">Nx::CModelLights::UpdateEngine</a></div><div class="ttdeci">void UpdateEngine(Mth::Vector &amp;pos, bool add_scene_light=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/_nx_light_8cpp_source.html#l00139">NxLight.cpp:139</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a886727b2c6aadbd18a9f4bf9cb12dc41"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a886727b2c6aadbd18a9f4bf9cb12dc41">NxXbox::sEngineGlobals::pixel_shader_constants</a></div><div class="ttdeci">float pixel_shader_constants[20]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00094">nx_init.h:94</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a93f01d1089d37e45a156db2c20bd1515"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a93f01d1089d37e45a156db2c20bd1515">NxXbox::CInstance::CInstance</a></div><div class="ttdeci">CInstance(sScene *pScene, Mth::Matrix &amp;transform, int numBones, Mth::Matrix *pBoneTransforms)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00245">instance.cpp:245</a></div></div>
<div class="ttc" id="anamespace_script_html_a1ef6ac6b15ddd2fcff21e6a3dd6e5938"><div class="ttname"><a href="../../d1/d54/namespace_script.html#a1ef6ac6b15ddd2fcff21e6a3dd6e5938">Script::GetFloat</a></div><div class="ttdeci">float GetFloat(uint32 checksum, EAssertType assert)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7c/symboltable_8cpp_source.html#l00483">symboltable.cpp:483</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_texture_html_a917fa9f4966c164d234cd05e0a6aedc3"><div class="ttname"><a href="../../d6/dd9/struct_nx_xbox_1_1s_texture.html#a917fa9f4966c164d234cd05e0a6aedc3">NxXbox::sTexture::pD3DTexture</a></div><div class="ttdeci">IDirect3DTexture8 * pD3DTexture</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d46/_x_box_2_n_x_2texture_8h_source.html#l00026">texture.h:26</a></div></div>
<div class="ttc" id="aclass_mth_1_1_matrix_html_adebc1381b71e980c126cc82aafb8b9fe"><div class="ttname"><a href="../../d9/d37/class_mth_1_1_matrix.html#adebc1381b71e980c126cc82aafb8b9fe">Mth::Matrix::Identity</a></div><div class="ttdeci">Matrix &amp; Identity(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d28/matrix_8inl_source.html#l00413">matrix.inl:413</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_af38fd7238471577d09a4186b9e63ebb5af401660c888c1e214ba6e9f31fd20ede"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5af401660c888c1e214ba6e9f31fd20ede">NxXbox::vRENDER_INSTANCE_PRE_WORLD_SEMITRANSPARENT</a></div><div class="ttdeci">@ vRENDER_INSTANCE_PRE_WORLD_SEMITRANSPARENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00096">render.h:96</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a862f5cbcc2b9cf9d68907675f5957eb4a161baec83a14f9894093ac490bf60963"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a862f5cbcc2b9cf9d68907675f5957eb4a161baec83a14f9894093ac490bf60963">NxXbox::CInstance::INSTANCE_FLAG_DELETE_ATTACHED_SCENE</a></div><div class="ttdeci">@ INSTANCE_FLAG_DELETE_ATTACHED_SCENE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00021">instance.h:21</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5adb3cb7f6e7c3f97ff1fe34c45a9f917b">NxXbox::vRENDER_NO_CULLING</a></div><div class="ttdeci">@ vRENDER_NO_CULLING</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00092">render.h:92</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_ace52a2342a88f178553e80c84b821199"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#ace52a2342a88f178553e80c84b821199">NxXbox::sMesh::m_flags</a></div><div class="ttdeci">uint32 m_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00113">mesh.h:113</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_a1d2462a15786553fa77791368bba253f"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#a1d2462a15786553fa77791368bba253f">WeightedMeshVS_VXC_1Weight</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_1Weight</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00043">anim.cpp:43</a></div></div>
<div class="ttc" id="amatrix_8h_html_ad393a55b0cd17b6dea798c49863e8de4"><div class="ttname"><a href="../../dd/df4/matrix_8h.html#ad393a55b0cd17b6dea798c49863e8de4">GetPos</a></div><div class="ttdeci">Vector &amp; GetPos(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00066">matrix.h:66</a></div></div>
<div class="ttc" id="ap__netcnfif_8h_html_a987f27df2a5f3c9f3b402784624cfac3"><div class="ttname"><a href="../../d7/dbd/p__netcnfif_8h.html#a987f27df2a5f3c9f3b402784624cfac3">p1</a></div><div class="ttdeci">unsigned char p1</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dbd/p__netcnfif_8h_source.html#l00038">p_netcnfif.h:38</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a00b7850740ec9a984248e14d78889852"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a00b7850740ec9a984248e14d78889852">NxXbox::frustum_check_sphere</a></div><div class="ttdeci">bool frustum_check_sphere(D3DXVECTOR3 *p_center, float radius)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l01930">render.cpp:1930</a></div></div>
<div class="ttc" id="aclass_mth_1_1_matrix_html_a019eca0aefed8bdfd54629c6dfcc81fb"><div class="ttname"><a href="../../d9/d37/class_mth_1_1_matrix.html#a019eca0aefed8bdfd54629c6dfcc81fb">Mth::Matrix::SetPos</a></div><div class="ttdeci">void SetPos(const Vector &amp;trans)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d28/matrix_8inl_source.html#l00770">matrix.inl:770</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_material_html_ad31897c8160e29447c188946d92edea5"><div class="ttname"><a href="../../da/df5/struct_nx_xbox_1_1s_material.html#ad31897c8160e29447c188946d92edea5">NxXbox::sMaterial::m_draw_order</a></div><div class="ttdeci">float m_draw_order</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d9f/_x_box_2_n_x_2material_8h_source.html#l00109">material.h:109</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a7f7272085a93a1646f35a8b304cb7a1a"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a7f7272085a93a1646f35a8b304cb7a1a">NxXbox::TestSphereAgainstOccluders</a></div><div class="ttdeci">bool TestSphereAgainstOccluders(D3DXVECTOR3 *p_center, float radius, uint32 meshes)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dbb/_x_box_2_n_x_2occlude_8cpp_source.html#l00447">occlude.cpp:447</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a8585f18012329ccc8c41cdf603f11d3d"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8585f18012329ccc8c41cdf603f11d3d">NxXbox::sEngineGlobals::allow_envmapping</a></div><div class="ttdeci">bool allow_envmapping</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00084">nx_init.h:84</a></div></div>
<div class="ttc" id="anamespace_mth_html_a7b9b1c529db03b284ac3fce278234cc2a56d801d6c06dea10a9a31e21da362bef"><div class="ttname"><a href="../../d5/db9/namespace_mth.html#a7b9b1c529db03b284ac3fce278234cc2a56d801d6c06dea10a9a31e21da362bef">Mth::RIGHT</a></div><div class="ttdeci">@ RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00049">matrix.h:49</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_af38fd7238471577d09a4186b9e63ebb5ab94d941829dcdef2e7ac21aacc218fdb"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5ab94d941829dcdef2e7ac21aacc218fdb">NxXbox::vRENDER_INSTANCE_POST_WORLD_SEMITRANSPARENT</a></div><div class="ttdeci">@ vRENDER_INSTANCE_POST_WORLD_SEMITRANSPARENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00097">render.h:97</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_texture_projection_details_html"><div class="ttname"><a href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html">NxXbox::sTextureProjectionDetails</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00050">render.h:50</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_abc37345517638e477d4e5ebde2044ac9"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#abc37345517638e477d4e5ebde2044ac9">NxXbox::set_texture</a></div><div class="ttdeci">void set_texture(uint32 pass, IDirect3DTexture8 *p_texture, IDirect3DPalette8 *p_palette)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l01130">render.cpp:1130</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a4fac7b6f6cf022b9aed58d542cf8be72"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a4fac7b6f6cf022b9aed58d542cf8be72">NxXbox::sEngineGlobals::pixel_shader_override</a></div><div class="ttdeci">DWORD pixel_shader_override</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00092">nx_init.h:92</a></div></div>
<div class="ttc" id="asse_8h_html_ae53e225bb0869de34215f031b7fdaa57"><div class="ttname"><a href="../../da/d49/sse_8h.html#ae53e225bb0869de34215f031b7fdaa57">Ftoi_ASM</a></div><div class="ttdeci">__forceinline int Ftoi_ASM(const float f)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d49/sse_8h_source.html#l00020">sse.h:20</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_afa8181f7caa5481d0a0b5bcc6c0112e2"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#afa8181f7caa5481d0a0b5bcc6c0112e2">NxXbox::sort_by_bone_transform</a></div><div class="ttdeci">static int sort_by_bone_transform(const void *p1, const void *p2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00023">instance.cpp:23</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_af12b2fc84e5f1f5aea8e7f512c4ca02a"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#af12b2fc84e5f1f5aea8e7f512c4ca02a">NxXbox::EngineGlobals</a></div><div class="ttdeci">sEngineGlobals EngineGlobals</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/_x_box_2_n_x_2nx__init_8cpp_source.html#l00020">nx_init.cpp:20</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html">NxXbox</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00063">anim.cpp:63</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_ad2ab4bdb61c8f0f00039d14ed45644f5"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#ad2ab4bdb61c8f0f00039d14ed45644f5">WeightedMeshVertexShader_SBWrite</a></div><div class="ttdeci">DWORD WeightedMeshVertexShader_SBWrite</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00052">anim.cpp:52</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_scene_html_a91cf038b863ac04e4ae109b972b761bb"><div class="ttname"><a href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a91cf038b863ac04e4ae109b972b761bb">NxXbox::sScene::m_numHierarchyObjects</a></div><div class="ttdeci">int m_numHierarchyObjects</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db8/_x_box_2_n_x_2scene_8h_source.html#l00074">scene.h:74</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_af9a41b989a910a00f7578e5ffe8f8529a20e63872b54017adbaffb3add7950867"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#af9a41b989a910a00f7578e5ffe8f8529a20e63872b54017adbaffb3add7950867">NxXbox::vBLEND_MODE_MODULATE_COLOR</a></div><div class="ttdeci">@ vBLEND_MODE_MODULATE_COLOR</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00081">render.h:81</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a03defcc333dc4dae5c05914d0a7b02bd"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a03defcc333dc4dae5c05914d0a7b02bd">NxXbox::pFirstInstance</a></div><div class="ttdeci">CInstance * pFirstInstance</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00016">instance.cpp:16</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a1c1e2d7613565b14cd823f7640682fdb"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a1c1e2d7613565b14cd823f7640682fdb">NxXbox::shutdown_weighted_mesh_vertex_shader</a></div><div class="ttdeci">void shutdown_weighted_mesh_vertex_shader(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00488">anim.cpp:488</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a14181f821d1aaf7263b61814cb268d35"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a14181f821d1aaf7263b61814cb268d35">NxXbox::sEngineGlobals::screen_angle</a></div><div class="ttdeci">float screen_angle</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00024">nx_init.h:24</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_aa0780820824923f8bc7ecf5bf1f2bc4b"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#aa0780820824923f8bc7ecf5bf1f2bc4b">NxXbox::sMesh::m_num_vertices</a></div><div class="ttdeci">uint16 m_num_vertices</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00128">mesh.h:128</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_ac36fb431fffccf2b05285166c498e3d6"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ac36fb431fffccf2b05285166c498e3d6">NxXbox::CInstance::mp_bone_transforms</a></div><div class="ttdeci">Mth::Matrix * mp_bone_transforms</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00048">instance.h:48</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_aeea1e1820132824403fc768475ceb9bd"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#aeea1e1820132824403fc768475ceb9bd">NxXbox::render_scene</a></div><div class="ttdeci">void render_scene(sScene *p_scene, uint32 flags, uint32 viewport)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l02466">render.cpp:2466</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a255bf2960f8ecde01b8fe5d227fdbf83"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a255bf2960f8ecde01b8fe5d227fdbf83">NxXbox::CInstance::GetModel</a></div><div class="ttdeci">Nx::CModel * GetModel(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00036">instance.h:36</a></div></div>
<div class="ttc" id="avector_8h_html_a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a5596231eabd6cf29050967d5ac83ad84">Y</a></div><div class="ttdeci">@ Y</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00068">vector.h:68</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a5cc6387878fc3819daf7cb0186ea5ce0"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5cc6387878fc3819daf7cb0186ea5ce0">NxXbox::CInstance::GetScene</a></div><div class="ttdeci">sScene * GetScene(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00030">instance.h:30</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_material_html"><div class="ttname"><a href="../../da/df5/struct_nx_xbox_1_1s_material.html">NxXbox::sMaterial</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d9f/_x_box_2_n_x_2material_8h_source.html#l00081">material.h:81</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a8a8933b9aa8ad3f8ddbbd2ed59329fd2"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a8a8933b9aa8ad3f8ddbbd2ed59329fd2">NxXbox::setup_weighted_mesh_vertex_shader</a></div><div class="ttdeci">void setup_weighted_mesh_vertex_shader(void *p_root_matrix, void *p_bone_matrices, int num_bone_matrices)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00308">anim.cpp:308</a></div></div>
<div class="ttc" id="anamespace_script_html_a023fa80aced222388397847244805794"><div class="ttname"><a href="../../d1/d54/namespace_script.html#a023fa80aced222388397847244805794">Script::max</a></div><div class="ttdeci">static int max</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d98/struct_8cpp_source.html#l00492">struct.cpp:492</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_scene_html"><div class="ttname"><a href="../../d8/d68/struct_nx_xbox_1_1s_scene.html">NxXbox::sScene</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/db8/_x_box_2_n_x_2scene_8h_source.html#l00028">scene.h:28</a></div></div>
<div class="ttc" id="aclass_mth_1_1_matrix_html_a269ae2fa628a2a388f98cd852619875e"><div class="ttname"><a href="../../d9/d37/class_mth_1_1_matrix.html#a269ae2fa628a2a388f98cd852619875e">Mth::Matrix::GetPos</a></div><div class="ttdeci">Vector &amp; GetPos(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00126">matrix.h:126</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_a14e9f854d177056042f3a9353aa5faae"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a14e9f854d177056042f3a9353aa5faae">NxXbox::sMesh::m_vertex_shader</a></div><div class="ttdeci">uint32 m_vertex_shader[VERTEX_SHADER_STACK_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00132">mesh.h:132</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a35d72b2c13344c58f8c1541d8a8717d1"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a35d72b2c13344c58f8c1541d8a8717d1">NxXbox::set_frustum_bbox_transform</a></div><div class="ttdeci">void set_frustum_bbox_transform(Mth::Matrix *p_transform)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l01873">render.cpp:1873</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a43b124443ceaec12d41c57830fe48f7d"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a43b124443ceaec12d41c57830fe48f7d">NxXbox::CInstance::GetNextInstance</a></div><div class="ttdeci">CInstance * GetNextInstance(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00037">instance.h:37</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_a833e140d6c8bcfad615ed65e2813681aa11f06c9a4885d4d144b8694cb17142c0"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a833e140d6c8bcfad615ed65e2813681aa11f06c9a4885d4d144b8694cb17142c0">NxXbox::sMesh::MESH_FLAG_UNLIT</a></div><div class="ttdeci">@ MESH_FLAG_UNLIT</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00060">mesh.h:60</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_afa785034898e6c626fdbfe5d2b18094d"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#afa785034898e6c626fdbfe5d2b18094d">WeightedMeshVS_VXC_2Weight_UVTransform</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_2Weight_UVTransform</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00050">anim.cpp:50</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_scene_html_a40d6ceb1649611a5dfd119512a9fafa4"><div class="ttname"><a href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a40d6ceb1649611a5dfd119512a9fafa4">NxXbox::sScene::m_num_semitransparent_mesh_entries</a></div><div class="ttdeci">int m_num_semitransparent_mesh_entries</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db8/_x_box_2_n_x_2scene_8h_source.html#l00054">scene.h:54</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_texture_projection_details_html_a5a288e36f7b84d920488072c34599269"><div class="ttname"><a href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a5a288e36f7b84d920488072c34599269">NxXbox::sTextureProjectionDetails::texture_projection_matrix</a></div><div class="ttdeci">XGMATRIX texture_projection_matrix</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00057">render.h:57</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_ac5e7dc241351e483fad6056c8a92aedb"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#ac5e7dc241351e483fad6056c8a92aedb">WeightedMeshVS_VXC_2Weight</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_2Weight</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00044">anim.cpp:44</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_a97f6ad6d5f66fc4279d601fe0cc6c215"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a97f6ad6d5f66fc4279d601fe0cc6c215">NxXbox::sMesh::m_vertex_stride</a></div><div class="ttdeci">uint8 m_vertex_stride</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00118">mesh.h:118</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_a3c564a178aec4091e87cd7b127cb4ef2"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a3c564a178aec4091e87cd7b127cb4ef2">NxXbox::sMesh::SetActive</a></div><div class="ttdeci">void SetActive(bool active)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00071">mesh.h:71</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_af28bc0482df30e6a0261cba338c315a1"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#af28bc0482df30e6a0261cba338c315a1">NxXbox::sEngineGlobals::texture_stage_override</a></div><div class="ttdeci">DWORD texture_stage_override</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00099">nx_init.h:99</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_a4274b62ba49181cfa2714c64c2459850"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#a4274b62ba49181cfa2714c64c2459850">WeightedMeshVS_VXC_1Weight_SBPassThru</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_1Weight_SBPassThru</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00053">anim.cpp:53</a></div></div>
<div class="ttc" id="aclass_mth_1_1_vector_html"><div class="ttname"><a href="../../d1/d08/class_mth_1_1_vector.html">Mth::Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00088">vector.h:88</a></div></div>
<div class="ttc" id="aclass_mth_1_1_matrix_html"><div class="ttname"><a href="../../d9/d37/class_mth_1_1_matrix.html">Mth::Matrix</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00060">matrix.h:60</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a09eb33a6d319e414581ccd470af6d1a1"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a09eb33a6d319e414581ccd470af6d1a1">NxXbox::sEngineGlobals::directional_light_color</a></div><div class="ttdeci">float directional_light_color[24]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00103">nx_init.h:103</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_texture_projection_details_html_a7a451ab2fb158c5b3154b07b12a593d9"><div class="ttname"><a href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a7a451ab2fb158c5b3154b07b12a593d9">NxXbox::sTextureProjectionDetails::p_model</a></div><div class="ttdeci">Nx::CXboxModel * p_model</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00053">render.h:53</a></div></div>
<div class="ttc" id="ap__netcnfif_8h_html_a22f7a8363a7f95b437d6df82a4284cd7"><div class="ttname"><a href="../../d7/dbd/p__netcnfif_8h.html#a22f7a8363a7f95b437d6df82a4284cd7">p2</a></div><div class="ttdeci">unsigned char p2</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dbd/p__netcnfif_8h_source.html#l00039">p_netcnfif.h:39</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a56fe2807aa16bdb672be15e2aa6a6812"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a56fe2807aa16bdb672be15e2aa6a6812">NxXbox::pLastBoneTransforms</a></div><div class="ttdeci">static Mth::Matrix * pLastBoneTransforms</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00015">instance.cpp:15</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a0fe0b18e5d5be7bb42cae3f693583105"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a0fe0b18e5d5be7bb42cae3f693583105">NxXbox::CInstance::m_flags</a></div><div class="ttdeci">uint32 m_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00046">instance.h:46</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a868ea66bba7a5a08a079c35a63768145"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a868ea66bba7a5a08a079c35a63768145">NxXbox::sEngineGlobals::world_matrix</a></div><div class="ttdeci">XGMATRIX world_matrix</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00015">nx_init.h:15</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a01e96222a8aac875c17a870a36d1d965"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a01e96222a8aac875c17a870a36d1d965">NxXbox::set_blend_mode</a></div><div class="ttdeci">void set_blend_mode(uint32 mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l01161">render.cpp:1161</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a862f5cbcc2b9cf9d68907675f5957eb4a74e5b5d59eafaffa1f0497fbfb93a90f"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a862f5cbcc2b9cf9d68907675f5957eb4a74e5b5d59eafaffa1f0497fbfb93a90f">NxXbox::CInstance::INSTANCE_FLAG_LIGHTING_ALLOWED</a></div><div class="ttdeci">@ INSTANCE_FLAG_LIGHTING_ALLOWED</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00022">instance.h:22</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_aa14da24ee9bc1b122fd451bd00a00207"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa14da24ee9bc1b122fd451bd00a00207">NxXbox::CInstance::GetNumBones</a></div><div class="ttdeci">int GetNumBones(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00027">instance.h:27</a></div></div>
<div class="ttc" id="asymboltable_8h_html"><div class="ttname"><a href="../../d6/d98/symboltable_8h.html">symboltable.h</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a9bd96f5d844699b85f4c18b62bfe9833"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a9bd96f5d844699b85f4c18b62bfe9833">NxXbox::CInstance::m_active</a></div><div class="ttdeci">bool m_active</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00050">instance.h:50</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_a3d8adada4894450d9bc781db82151026"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#a3d8adada4894450d9bc781db82151026">WeightedMeshVS_VXC_3Weight_SBPassThru</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_3Weight_SBPassThru</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00055">anim.cpp:55</a></div></div>
<div class="ttc" id="aclass_nx_1_1_c_light_manager_html_aba013f530e33da6c741cc368ac92dae0"><div class="ttname"><a href="../../d9/d46/class_nx_1_1_c_light_manager.html#aba013f530e33da6c741cc368ac92dae0">Nx::CLightManager::sUpdateEngine</a></div><div class="ttdeci">static void sUpdateEngine(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d41/_nx_light_man_8cpp_source.html#l00075">NxLightMan.cpp:75</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_af169397368451c254aef09298bec304a"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#af169397368451c254aef09298bec304a">NxXbox::set_render_state</a></div><div class="ttdeci">void set_render_state(uint32 type, uint32 state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l01432">render.cpp:1432</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html">NxXbox::CInstance</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00015">instance.h:15</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a36a8aed54dca98c4e17ba501f57665cb"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a36a8aed54dca98c4e17ba501f57665cb">NxXbox::sEngineGlobals::material_override</a></div><div class="ttdeci">DWORD material_override</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00100">nx_init.h:100</a></div></div>
<div class="ttc" id="aclass_nx_1_1_c_model_lights_html"><div class="ttname"><a href="../../d2/d32/class_nx_1_1_c_model_lights.html">Nx::CModelLights</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d45/_nx_light_8h_source.html#l00022">NxLight.h:22</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a7ab2d41a1053bd29a3a2c75c04983c56"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a7ab2d41a1053bd29a3a2c75c04983c56">NxXbox::set_pixel_shader</a></div><div class="ttdeci">void set_pixel_shader(uint32 shader_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l01369">render.cpp:1369</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_texture_projection_details_html_aab3098e227188d8bd166afd4ce9528f6"><div class="ttname"><a href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#aab3098e227188d8bd166afd4ce9528f6">NxXbox::sTextureProjectionDetails::p_texture</a></div><div class="ttdeci">sTexture * p_texture</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00052">render.h:52</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_ac3a82d55d5971bfff1b049d6aa73f4f9"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#ac3a82d55d5971bfff1b049d6aa73f4f9">NxXbox::CInstance::mp_next_instance</a></div><div class="ttdeci">CInstance * mp_next_instance</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00053">instance.h:53</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_scene_html_ac8b1b40b99999d1f37bbeed8e734bb9c"><div class="ttname"><a href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#ac8b1b40b99999d1f37bbeed8e734bb9c">NxXbox::sScene::m_first_semitransparent_entry</a></div><div class="ttdeci">int m_first_semitransparent_entry</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db8/_x_box_2_n_x_2scene_8h_source.html#l00056">scene.h:56</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_aae00671dc054b7acee28341365412693"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#aae00671dc054b7acee28341365412693">NxXbox::sMesh::GetBoneIndex</a></div><div class="ttdeci">int8 GetBoneIndex(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00078">mesh.h:78</a></div></div>
<div class="ttc" id="aanim__vertdefs_8h_html"><div class="ttname"><a href="../../de/d5f/anim__vertdefs_8h.html">anim_vertdefs.h</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a89d339689c1b2b21b0c02e078a15aaae"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a89d339689c1b2b21b0c02e078a15aaae">NxXbox::render_instances</a></div><div class="ttdeci">void render_instances(uint32 flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00133">instance.cpp:133</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a54878f586bbff3ede56cc29d0ca88fb3"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a54878f586bbff3ede56cc29d0ca88fb3">NxXbox::CInstance::RenderShadowVolume</a></div><div class="ttdeci">void RenderShadowVolume(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00680">instance.cpp:680</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a6d6adf40e13d0f60762fdd5e87eaf8c8"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a6d6adf40e13d0f60762fdd5e87eaf8c8">NxXbox::pTextureProjectionDetailsTable</a></div><div class="ttdeci">Lst::HashTable&lt; sTextureProjectionDetails &gt; * pTextureProjectionDetailsTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l00065">render.cpp:65</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a8b8810bf61e9567bc4c961c8e6985759"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a8b8810bf61e9567bc4c961c8e6985759">NxXbox::sEngineGlobals::cam_position</a></div><div class="ttdeci">XGVECTOR3 cam_position</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00031">nx_init.h:31</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_scene_html_a1d262cf8d090a7c21d8176d3c1cea899"><div class="ttname"><a href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a1d262cf8d090a7c21d8176d3c1cea899">NxXbox::sScene::m_meshes</a></div><div class="ttdeci">sMesh ** m_meshes</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db8/_x_box_2_n_x_2scene_8h_source.html#l00052">scene.h:52</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_a267e786eecc45a749f6b84c4c5d6384b"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a267e786eecc45a749f6b84c4c5d6384b">NxXbox::sMesh::PushVertexShader</a></div><div class="ttdeci">void PushVertexShader(uint32 shader_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d76/_x_box_2_n_x_2mesh_8cpp_source.html#l00295">mesh.cpp:295</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_af38fd7238471577d09a4186b9e63ebb5a98fec178c2e30a07233f312da65100d3"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a98fec178c2e30a07233f312da65100d3">NxXbox::vRENDER_SEMITRANSPARENT</a></div><div class="ttdeci">@ vRENDER_SEMITRANSPARENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00090">render.h:90</a></div></div>
<div class="ttc" id="aclass_nx_1_1_c_model_html_a99f6c91e9c8cb1e752d8b9cf251aa49c"><div class="ttname"><a href="../../d0/dea/class_nx_1_1_c_model.html#a99f6c91e9c8cb1e752d8b9cf251aa49c">Nx::CModel::GetModelLights</a></div><div class="ttdeci">CModelLights * GetModelLights() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d45/_nx_model_8cpp_source.html#l00725">NxModel.cpp:725</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_ade65b339f79a19614775db76aade229b"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#ade65b339f79a19614775db76aade229b">NxXbox::sMesh::mp_material</a></div><div class="ttdeci">sMaterial * mp_material</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00116">mesh.h:116</a></div></div>
<div class="ttc" id="avector_8h_html_a97b62c44fa0ff9823c90a7588a9627c0"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a97b62c44fa0ff9823c90a7588a9627c0">Vector</a></div><div class="ttdeci">Vector()</div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_scene_html_abdf14b2a7484a3bcce0d68ec0c18a3f9"><div class="ttname"><a href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#abdf14b2a7484a3bcce0d68ec0c18a3f9">NxXbox::sScene::m_num_mesh_entries</a></div><div class="ttdeci">int m_num_mesh_entries</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db8/_x_box_2_n_x_2scene_8h_source.html#l00053">scene.h:53</a></div></div>
<div class="ttc" id="avector_8h_html_a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635a58833a3110c570fb05130d40c365d1e4">X</a></div><div class="ttdeci">@ X</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00068">vector.h:68</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_a88d92011d056439b7de12577f787e27a"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#a88d92011d056439b7de12577f787e27a">WeightedMeshVS_VXC_Specular_2Weight</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_Specular_2Weight</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00047">anim.cpp:47</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_scene_html_a871dd3e456db25552a5a9c1163bf4421"><div class="ttname"><a href="../../d8/d68/struct_nx_xbox_1_1s_scene.html#a871dd3e456db25552a5a9c1163bf4421">NxXbox::sScene::m_sphere_radius</a></div><div class="ttdeci">float m_sphere_radius</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db8/_x_box_2_n_x_2scene_8h_source.html#l00070">scene.h:70</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_af4f8c3af9a44b5bf9954ed7b93fda4f5"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#af4f8c3af9a44b5bf9954ed7b93fda4f5">NxXbox::CInstance::Render</a></div><div class="ttdeci">void Render(uint32 flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00314">instance.cpp:314</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_texture_projection_details_html_a952b60b67e9e03aeb25aa82ebaa3896d"><div class="ttname"><a href="../../d9/ddf/struct_nx_xbox_1_1s_texture_projection_details.html#a952b60b67e9e03aeb25aa82ebaa3896d">NxXbox::sTextureProjectionDetails::view_matrix</a></div><div class="ttdeci">XGMATRIX view_matrix</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00055">render.h:55</a></div></div>
<div class="ttc" id="avector_8h_html_a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a726ca809ffd3d67ab4b8476646f26635aa70478ce277ffc322f8e1e3418e07355">Z</a></div><div class="ttdeci">@ Z</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00068">vector.h:68</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2render_8cpp_html_aee030a275c0b85f7a3edf1c8ff8ba4c3"><div class="ttname"><a href="../../d2/dad/_x_box_2_n_x_2render_8cpp.html#aee030a275c0b85f7a3edf1c8ff8ba4c3">PixelShader_ShadowBuffer</a></div><div class="ttdeci">DWORD PixelShader_ShadowBuffer</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l00049">render.cpp:49</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html_a238e8c9dfed99feb2d837fa7cdaf3009"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html#a238e8c9dfed99feb2d837fa7cdaf3009">NxXbox::sMesh::PopVertexShader</a></div><div class="ttdeci">void PopVertexShader(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d76/_x_box_2_n_x_2mesh_8cpp_source.html#l00310">mesh.cpp:310</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_aba834bb3cfcd30127eb37ccbdfe361ac"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aba834bb3cfcd30127eb37ccbdfe361ac">NxXbox::CInstance::GetActive</a></div><div class="ttdeci">bool GetActive(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00032">instance.h:32</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_af38fd7238471577d09a4186b9e63ebb5a6383f31ae48f9893e8a216db1c9264ad"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#af38fd7238471577d09a4186b9e63ebb5a6383f31ae48f9893e8a216db1c9264ad">NxXbox::vRENDER_OPAQUE</a></div><div class="ttdeci">@ vRENDER_OPAQUE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/_x_box_2_n_x_2render_8h_source.html#l00089">render.h:89</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a35a143572a74a014525185af4a7759e6"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a35a143572a74a014525185af4a7759e6">NxXbox::sEngineGlobals::ambient_light_color</a></div><div class="ttdeci">float ambient_light_color[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00102">nx_init.h:102</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2anim_8cpp_html_ae70dcaf5276679e8c417aff141604cdb"><div class="ttname"><a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp.html#ae70dcaf5276679e8c417aff141604cdb">WeightedMeshVS_VXC_2Weight_SBPassThru</a></div><div class="ttdeci">DWORD WeightedMeshVS_VXC_2Weight_SBPassThru</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dbd/_x_box_2_n_x_2anim_8cpp_source.html#l00054">anim.cpp:54</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a5659529288c63eb0357f0d7e916dc7b2"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a5659529288c63eb0357f0d7e916dc7b2">NxXbox::CInstance::~CInstance</a></div><div class="ttdeci">~CInstance()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00281">instance.cpp:281</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_a3ec58f46c4866090bba39c984b11c91d"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#a3ec58f46c4866090bba39c984b11c91d">NxXbox::CInstance::SetTransform</a></div><div class="ttdeci">void SetTransform(Mth::Matrix &amp;transform)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00025">instance.h:25</a></div></div>
<div class="ttc" id="anamespace_mth_html_a4829497c960aa6d670291025162364d0"><div class="ttname"><a href="../../d5/db9/namespace_mth.html#a4829497c960aa6d670291025162364d0">Mth::DistanceSqr</a></div><div class="ttdeci">float DistanceSqr(const Vector &amp;v1, const Vector &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5f/vector_8inl_source.html#l01059">vector.inl:1059</a></div></div>
<div class="ttc" id="a_x_box_2_n_x_2render_8cpp_html_a6cc9a2457d968232a1d91150cb5a4c62"><div class="ttname"><a href="../../d2/dad/_x_box_2_n_x_2render_8cpp.html#a6cc9a2457d968232a1d91150cb5a4c62">PixelShaderNULL</a></div><div class="ttdeci">DWORD PixelShaderNULL</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l00047">render.cpp:47</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a26eda17b0f46b5f5b914f683b8af7e77"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a26eda17b0f46b5f5b914f683b8af7e77">NxXbox::set_vertex_shader</a></div><div class="ttdeci">void set_vertex_shader(DWORD shader_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dad/_x_box_2_n_x_2render_8cpp_source.html#l01350">render.cpp:1350</a></div></div>
<div class="ttc" id="aclass_nx_xbox_1_1_c_instance_html_aa4ee948f4d9d84ac3836dc3b3f11de82"><div class="ttname"><a href="../../d8/d5a/class_nx_xbox_1_1_c_instance.html#aa4ee948f4d9d84ac3836dc3b3f11de82">NxXbox::CInstance::GetTransform</a></div><div class="ttdeci">Mth::Matrix * GetTransform(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db3/_x_box_2_n_x_2instance_8h_source.html#l00026">instance.h:26</a></div></div>
<div class="ttc" id="anamespace_nx_ngc_html_a295bf3c80cff21498c12ee374c043600"><div class="ttname"><a href="../../da/d63/namespace_nx_ngc.html#a295bf3c80cff21498c12ee374c043600">NxNgc::current_index</a></div><div class="ttdeci">int current_index</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df7/_n_g_c_2_n_x_2instance_8cpp_source.html#l00080">instance.cpp:80</a></div></div>
<div class="ttc" id="aclass_mth_1_1_matrix_html_a84f51ecd28902b7c9fccd38fdae1ad85"><div class="ttname"><a href="../../d9/d37/class_mth_1_1_matrix.html#a84f51ecd28902b7c9fccd38fdae1ad85">Mth::Matrix::GetRight</a></div><div class="ttdeci">Vector &amp; GetRight(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00123">matrix.h:123</a></div></div>
<div class="ttc" id="anamespace_mth_html_a5a88e8aff5b7bdd63a88cd62c1485814"><div class="ttname"><a href="../../d5/db9/namespace_mth.html#a5a88e8aff5b7bdd63a88cd62c1485814">Mth::DegToRad</a></div><div class="ttdeci">float DegToRad(float degrees)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/_math_2math_8h_source.html#l00447">math.h:447</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_mesh_html"><div class="ttname"><a href="../../d6/d5e/struct_nx_xbox_1_1s_mesh.html">NxXbox::sMesh</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6e/_x_box_2_n_x_2mesh_8h_source.html#l00039">mesh.h:39</a></div></div>
<div class="ttc" id="anamespace_nx_xbox_html_a91b8baea31ab13e2cfc7a29edeccc56d"><div class="ttname"><a href="../../d4/ddf/namespace_nx_xbox.html#a91b8baea31ab13e2cfc7a29edeccc56d">NxXbox::render_instance</a></div><div class="ttdeci">void render_instance(CInstance *p_instance, uint32 flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d19/_x_box_2_n_x_2instance_8cpp_source.html#l00084">instance.cpp:84</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a34c0a95d57d46baff53420aa353d0f12"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a34c0a95d57d46baff53420aa353d0f12">NxXbox::sEngineGlobals::vertex_shader_override</a></div><div class="ttdeci">DWORD vertex_shader_override</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00098">nx_init.h:98</a></div></div>
<div class="ttc" id="astruct_nx_xbox_1_1s_engine_globals_html_a4295cb5e56a5fcd425f82e66950858a4"><div class="ttname"><a href="../../da/db8/struct_nx_xbox_1_1s_engine_globals.html#a4295cb5e56a5fcd425f82e66950858a4">NxXbox::sEngineGlobals::upload_pixel_shader_constants</a></div><div class="ttdeci">bool upload_pixel_shader_constants</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_x_box_2_n_x_2nx__init_8h_source.html#l00097">nx_init.h:97</a></div></div>
<div class="ttc" id="aclass_mth_1_1_matrix_html_a66d839b730e37ef73b1dff15edebd754"><div class="ttname"><a href="../../d9/d37/class_mth_1_1_matrix.html#a66d839b730e37ef73b1dff15edebd754">Mth::Matrix::GetAt</a></div><div class="ttdeci">Vector &amp; GetAt(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df4/matrix_8h_source.html#l00125">matrix.h:125</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_c86603f79b902ad390ffc2674fbc4470.html">gfx</a></li><li class="navelem"><a class="el" href="../../dir_f1e3aad0a8b25f72ef4018f1d1f27bef.html">XBox</a></li><li class="navelem"><a class="el" href="../../dir_17ac0882b9f307ce11d41f7e7c182a97.html">NX</a></li><li class="navelem"><a class="el" href="../../d4/d19/_x_box_2_n_x_2instance_8cpp.html">instance.cpp</a></li>
    <li class="footer">Документация по OpenTHUG. Последние изменения: Вс 26 Апр 2020 03:47:26. Создано системой
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
